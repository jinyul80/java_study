<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
    layout:decorate="~{layouts/default_layout}">
<!-- Content -->
<div layout:fragment="content">
    <div class="container m-2">
        <form>
            <div class="form-group">
                <label for="username">Username:</label>
                <input type="text" class="form-control" placeholder="Enter Username" id="username" />
            </div>
            <div class="form-group">
                <label for="password">Password:</label>
                <input type="password" class="form-control" placeholder="Enter password" id="password" />
            </div>
            <div class="form-group form-check">
                <label class="form-check-label"> <input class="form-check-input" type="checkbox" /> Remember me </label>
            </div>
        </form>

        <button class="btn btn-primary" id="btn-login">로그인</button>
    </div>

    <script th:inline="javascript">
        function login() {
            let data = {
                username: $("#username").val(),
                password: $("#password").val(),
            };

            if (data.username == "") {
                alert("Username을 입력하세요.");
                return;
            } else if (data.password == "") {
                alert("Password을 입력하세요.");
                return;
            }

            $.ajax({
                type: "POST",
                url: "/blog/user/login",
                data: JSON.stringify(data),
                contentType: "application/json;charset=utf-8",
                dataType: "json",
            })
                .done(function (resp) {
                    if (resp.status == 200) {
                        alert("로그인이 완료되었습니다.");
                        location.href = "/blog";
                    } else {
                        alert("Username 또는 Password가 틀렸습니다.");
                    }
                })
                .fail(function (error) {
                    console.log(error);
                    alert(error.responseJSON.message);
                });
        }

        window.onload = function () {
            $("#btn-login").on("click", login);
        };
    </script>
</div>

</html>